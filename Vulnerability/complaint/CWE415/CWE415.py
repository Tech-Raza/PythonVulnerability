import ctypes


# Define a C structure for the vulnerable object
class VulnerableObject(ctypes.Structure):
    _fields_ = [("data", ctypes.POINTER(ctypes.c_char)),
                ("size", ctypes.c_int)]


def delete_object(obj_ptr):
    # CWE-415: Double Free - Attempt to free memory twice
    # The memory pointed to by obj_ptr is freed twice, causing a double free vulnerability
    ctypes.free(obj_ptr)
    ctypes.free(obj_ptr)


# Create a vulnerable object and free it
obj_ptr = ctypes.pointer(VulnerableObject(ctypes.c_char_p(b"hello"), 5))
delete_object(obj_ptr)
